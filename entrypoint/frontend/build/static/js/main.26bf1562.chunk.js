(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,n){e.exports=n(52)},29:function(e,t,n){},49:function(e,t,n){e.exports=n.p+"static/media/lym-rush-logo-white.2c0e3b7c.png"},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(17),o=n.n(i),l=(n(27),n(29),n(20)),s=n(3),c=n(4),u=n(6),d=n(5),m=n(7),g=n(9),f=n.n(g);n(49);var h=function(e){var t=r.a.createElement("div",{className:"logout-container",onClick:e.handle_logout},"Logout");return r.a.createElement("div",null,e.logged_in?t:null)},p=n(21),v=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:""},n.handle_change=function(e){var t=e.target.name,a=e.target.value;n.setState(function(e){var n=Object(p.a)({},e);return n[t]=a,n})},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("form",{className:"login-form",onSubmit:function(t){return e.props.handle_login(t,e.state)}},r.a.createElement("label",{className:"login-label",htmlFor:"username"},"Username",r.a.createElement("input",{type:"text",name:"username",value:this.state.username,className:"login-input",onChange:this.handle_change})),r.a.createElement("label",{className:"login-label",htmlFor:"password"},"Password",r.a.createElement("input",{type:"password",name:"password",value:this.state.password,className:"login-input",onChange:this.handle_change})),r.a.createElement("br",null),r.a.createElement("input",{className:"login-submit",type:"submit"}))}}]),t}(r.a.Component),y=n(54),w=n(55),b=n(56),k=n(57),S=n(58);function E(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var I=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).refreshList=function(){f.a.get("".concat(n.baseUrl,"/api/readings/"),{headers:{"Content-type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("token"))}}).then(function(e){var t=e.data;n.setState({readingList:n.removeFutureReadings(t)}),n.setState({currentItem:n.getTodaysReading()})}).catch(function(e){console.log(e),n.setState({loginError:!0,logged_in:n.requiresLogin||!1,username:null,displayed_form:"login",currentItem:null}),localStorage.removeItem("token")})},n.getNewsItem=function(){f.a.get("".concat(n.baseUrl,"/api/news_items/"),{headers:{"Content-type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("token"))}}).then(function(e){var t=e.data;n.setState({news_items:t})}).catch(function(e){console.log(e),n.setState({loginError:!0,logged_in:n.requiresLogin||!1,username:null,displayed_form:"login",currentItem:null}),localStorage.removeItem("token")})},n.handle_login=function(e,t){var a=n.getCookie("csrftoken");n.setState({loginError:!1}),e.preventDefault(),fetch("".concat(n.baseUrl,"/token-auth/"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRFTOKEN":a},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){localStorage.setItem("token",e.token),n.setState({logged_in:!0,displayed_form:"",username:e.user.username}),n.refreshList(),n.getNewsItem()}).catch(function(e){n.setState({loginError:!0,logged_in:n.requiresLogin||!0,username:null,displayed_form:"login",currentItem:null}),localStorage.removeItem("token")})},n.handle_logout=function(){localStorage.removeItem("token"),n.setState({logged_in:n.requiresLogin||!1,username:""})},n.display_form=function(e){n.setState({displayed_form:e})},n.getTodaysReading=function(){var e=n.state.readingList,t=n.getClosestReadingToToday(Object(l.a)(e));return n.setState({currentItem:t}),t},n.getTodaysNewsItem=function(){var e=n.state.news_items;return e?n.getClosestNewsItemToToday(e):null},n.displayCompleted=function(e){return e?n.setState({viewCompleted:!0}):n.setState({viewCompleted:!1})},n.renderItems=function(){var e=n.state.currentItem;return e?r.a.createElement("div",{className:"items",key:e.id},r.a.createElement("div",{key:e.id,className:"reading-title"},e.title),n.createCircleIcon(r.a.createElement(y.a,{style:{fontSize:"30px",color:"#13395c"},className:"circle-icon-logo"}),"Read"),n.parseString(e.bible_text,"reading-item"),n.createCircleIcon(r.a.createElement(w.a,{style:{fontSize:"30px",color:"#13395c"},className:"circle-icon-logo"}),"Engage"),n.parseString(e.question_text,"reading-item"),n.createCircleIcon(r.a.createElement(b.a,{style:{fontSize:"30px",color:"#13395c"},className:"circle-icon-logo"}),"Pray"),n.parseString(e.prayer_text,"reading-item prayer-text"),n.isMobile?r.a.createElement("div",{className:"page-footer"},r.a.createElement("div",{className:"day-by-day-title"},"Day By Day")):null):null},n.forwardClick=function(e){var t=n.state.readingList.findIndex(function(e){return e.id===n.state.currentItem.id});n.setState({currentItem:n.state.readingList[t-1]||n.state.currentItem})},n.backwardClick=function(e){var t=n.state.readingList.findIndex(function(e){return e.id===n.state.currentItem.id});n.setState({currentItem:n.state.readingList[t+1]||n.state.currentItem})},n.requiresLogin=!1,n.isMobile=!(window.innerWidth>600),n.state={viewCompleted:!1,activeItem:{title:"",description:"",completed:!1,reading_date:""},readingList:[],displayed_form:"",logged_in:!(!localStorage.getItem("token")&&n.requiresLogin),username:""},n.baseUrl=window.location.protocol+"//"+window.location.host,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.logged_in&&(this.requiresLogin?fetch("".concat(this.baseUrl,"/current_user/"),{headers:{Authorization:"JWT ".concat(localStorage.getItem("token"))}}).then(function(e){return e.json()}).then(function(t){e.setState({username:t.username}),e.refreshList(),e.getNewsItem()}):(this.refreshList(),this.getNewsItem()))}},{key:"getCookie",value:function(e){if(!document.cookie)return null;var t=document.cookie.split(";").map(function(e){return e.trim()}).filter(function(t){return t.startsWith(e+"=")});return 0===t.length?null:decodeURIComponent(t[0].split("=")[1])}},{key:"renderLoginError",value:function(){return r.a.createElement("div",{className:"login-failed"},"Incorrect username or password")}},{key:"sortDyDate",value:function(e){return e.forEach(function(e){e.reading_date=new Date(e.reading_date)}),e.sort(function(e,t){return new Date(e.reading_date)-new Date(t.reading_date)})}},{key:"removeFutureReadings",value:function(e){var t=new Date,n=e.filter(function(e){return new Date(e.reading_date)<=t});return console.log(e,n),n}},{key:"getClosestReadingToToday",value:function(e){var t=new Date;return e.sort(function(e,n){return Math.abs(t-new Date(e.reading_date))-Math.abs(t-new Date(n.reading_date))}),e[0]}},{key:"getClosestNewsItemToToday",value:function(e){var t=new Date;return e.sort(function(e,n){return Math.abs(t-new Date(e.news_date))-Math.abs(t-new Date(n.news_date))}),e[0]?e[0].news_item_text:null}},{key:"handleSidebarItemClick",value:function(e){this.setState({currentItem:e})}},{key:"parseString",value:function(e,t){var n=this;return e.split("/n").map(function(e){return r.a.createElement("p",{key:e.slice(10),className:t},n.parseSuperScript(e))})}},{key:"parseSuperScript",value:function(e){if(-1===e.indexOf("/^"))return e;var t=e.split("/^"),n=[];return t.forEach(function(e){var t=e.indexOf(" ");-1!==t&&(n.push(r.a.createElement("sup",null,e.slice(0,t))),e=e.slice(t));var a,i=E(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;n.push(o)}}catch(l){i.e(l)}finally{i.f()}}),n}},{key:"createCircleIcon",value:function(e,t){return r.a.createElement("div",{className:"header-dot"},e,r.a.createElement("div",{className:"header-text"},t))}},{key:"renderSidebar",value:function(){var e=this,t=this.state.readingList;return t?t.map(function(t){return r.a.createElement("li",{key:t.id,className:"sidebar-item",value:t.id,onClick:function(){e.handleSidebarItemClick(t)}},r.a.createElement("span",{className:"siderbar-title"},t.title,r.a.createElement("p",null,e.formatDate(t.reading_date))))}):null}},{key:"renderApp",value:function(){return this.state.currentItem?r.a.createElement("div",{style:{minHeight:"100vh",position:"relative"}},r.a.createElement("div",{className:"arrow-container"},r.a.createElement("div",{className:"back-button",onClick:this.backwardClick},r.a.createElement(k.a,{style:{fontSize:"25px"}})),r.a.createElement("div",{className:"page-title"},this.formatDate(this.state.currentItem.reading_date)),r.a.createElement("div",{className:"forward-button",onClick:this.forwardClick},r.a.createElement(S.a,{style:{fontSize:"25px"}}))),r.a.createElement("div",{className:"sidebar-list-container"},r.a.createElement("ul",{className:"sidebar-list"},this.renderSidebar())),r.a.createElement("ul",{className:"list-group list-group-flush"},this.renderItems()),r.a.createElement("div",{className:"news-bar"},this.getTodaysNewsItem())):null}},{key:"handleLogoClick",value:function(){window.location.assign("https://www.lymingtonrushmore.org/")}},{key:"handleFBClick",value:function(){window.location.assign("https://www.facebook.com/LRHolidays")}},{key:"handleIGClick",value:function(){window.location.assign("https://www.instagram.com/lrholidays/")}},{key:"render",value:function(){var e=this.state.logged_in?null:r.a.createElement(v,{handle_login:this.handle_login}),t=this.state.loginError?this.renderLoginError():null;return r.a.createElement("div",{className:"App"},this.isMobile?null:r.a.createElement("div",{className:"page-header"}),this.requiresLogin?r.a.createElement(h,{logged_in:this.state.logged_in,display_form:this.display_form,handle_logout:this.handle_logout}):null,e,t,this.state.logged_in?this.renderApp():null)}},{key:"formatDate",value:function(e){return e?new Date(e).toLocaleDateString("en-UK",{weekday:"long",month:window.innerWidth>600?"long":"short",day:"numeric"}):null}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.26bf1562.chunk.js.map